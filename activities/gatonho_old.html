<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gatonho - Chuva Games</title>
    
    <script>
        JavatariFullScreenSetup = { apply: function fullScreenSetup() { /* Setup Basic full-screen CSS*/ if (!this.cssApplied) { var style = document.createElement('style'); style.type = 'text/css'; style.innerHTML = this.css; document.head.appendChild(style); this.cssApplied = true; } /* Apply Standalone mode full-screen basic styles to html and body immediately if needed*/ document.documentElement.classList.toggle("jt-full-screen", this.shouldStartInFullScreen()); }, shouldStartInFullScreen: function () { return window.Javatari ? Javatari.SCREEN_FULLSCREEN_MODE === 1 || (Javatari.SCREEN_FULLSCREEN_MODE === -1 && this.isBrowserStandaloneMode()) : this.isBrowserStandaloneMode(); }, isBrowserStandaloneMode: function () { return navigator.standalone || window.matchMedia("(display-mode: standalone)").matches; }, css: '' + 'html.jt-full-screen, html.jt-full-screen body {' + '   background: black;' + '}' + 'html.jt-full-screen .jt-full-screen-hidden {' + '   display: none;' + '}' + 'html:not(.jt-full-screen) .jt-full-screen-only {' + '   display: none;' + '}'}; JavatariFullScreenSetup.apply();
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #2f3136;
            color: #dcddde;
            font-family: 'Whitney', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background-color: #36393f;
            padding: 16px 20px;
            border-bottom: 1px solid #40444b;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            flex-shrink: 0;
        }

        .logo {
            width: 32px;
            height: 32px;
            border-radius: 6px;
        }

        .title {
            color: #cdd755;
            font-size: 18px;
            font-weight: 600;
            text-align: center;
        }

        .game-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background-color: #2f3136;
        }

        .emulator-wrapper {
            width: 100%;
            max-width: 800px;
            height: 100%;
            max-height: 600px;
            background-color: #40444b;
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.24);
            display: flex;
            flex-direction: column;
        }

        #javatari-screen {
            width: 100%;
            height: 100%;
            border-radius: 4px;
            background-color: #000;
            min-height: 400px;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            color: #b9bbbe;
            font-size: 14px;
        }

        .controls-info {
            margin-top: 12px;
            padding: 12px;
            background-color: #36393f;
            border-radius: 4px;
            font-size: 12px;
            color: #b9bbbe;
            text-align: center;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .header {
                padding: 12px 16px;
            }
            
            .title {
                font-size: 16px;
            }
            
            .logo {
                width: 28px;
                height: 28px;
            }
            
            .game-container {
                padding: 12px;
            }
            
            .emulator-wrapper {
                padding: 12px;
                max-height: none;
                height: calc(100vh - 120px);
            }
            
            #javatari-screen {
                min-height: 300px;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 8px 12px;
            }
            
            .title {
                font-size: 14px;
            }
            
            .logo {
                width: 24px;
                height: 24px;
            }
            
            .game-container {
                padding: 8px;
            }
            
            .emulator-wrapper {
                padding: 8px;
                height: calc(100vh - 100px);
            }
            
            #javatari-screen {
                min-height: 250px;
            }
            
            .controls-info {
                font-size: 11px;
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="chuvamain.webp" alt="Chuva Games" class="logo">
        <h1 class="title">Gatonho: Quest 4 Rings</h1>
    </div>
    
    <div class="game-container">
        <div class="emulator-wrapper">
            <div id="javatari-screen">
                <div class="loading">Carregando emulador...</div>
            </div>
            <div class="controls-info">
                Use as setas do teclado para mover e a barra de espaço para ação
            </div>
        </div>
    </div>

    <script>
        // Javatari version 5.0.4
        // Copyright 2015 by Paulo Augusto Peccin. See license.txt distributed with this file.
        
        // Main Emulator parameters.
        // May be overridden dynamically by URL query parameters, if ALLOW_URL_PARAMETERS = true.
        
        Javatari = {
            PRESETS:                        "",                         // Configuration Presets to apply. See Presets Configuration
            
            // Full or relative URL of Media files to load
            CARTRIDGE_URL:                  "../assets/roms/gatonho.bin",
            AUTODETECT_URL:                 "../assets/roms/gatonho.bin",
            STATE_URL:                      "",
            
            // Forcing ROM formats
            CARTRIDGE_FORMAT:               "",                         // 4K, F8, F4, FE, AR, etc...
            
            // NetPlay
            NETPLAY_JOIN:                   "",                         // Join NetPlay! Session automatically
            NETPLAY_NICK:                   "",                         // NetPlay! Nickname
            
            // General configuration
            AUTO_START:                     true,
            AUTO_POWER_ON_DELAY:            100,                        // -1: no auto Power-ON; >= 0: wait specified milliseconds before Power-ON
            CARTRIDGE_SHOW_RECENT:          true,
            CARTRIDGE_CHANGE_DISABLED:      false,
            CARTRIDGE_LABEL_COLORS:         "",                         // Space-separated colors for Label, Background, Border. e.g. "#f00 #000 transparent". Leave "" for defaults
            SCREEN_RESIZE_DISABLED:         false,
            SCREEN_CONSOLE_PANEL_DISABLED:  false,
            SCREEN_ELEMENT_ID:              "javatari-screen",
            CONSOLE_PANEL_ELEMENT_ID:       -1,                         // -1: auto. Don't change! :-)
            SCREEN_FULLSCREEN_MODE:         -1,                         // -2: disabled; -1: auto; 0: off; 1: on
            SCREEN_CRT_MODE:                0,                          // -1: auto; 0: off; 1: on
            SCREEN_FILTER_MODE:             -3,                         // -3: user set (default auto); -2: browser default; -1: auto; 0..3: smoothing level
            SCREEN_DEFAULT_SCALE:           -1,                         // -1: auto; 0.5..N in 0.1 steps: scale
            SCREEN_DEFAULT_ASPECT:          1,                          // in 0.1 steps
            SCREEN_CANVAS_SIZE:             2,                          // Internal canvas size factor. Don't change! :-)
            SCREEN_CONTROL_BAR:             1,                          // 0: on hover; 1: always
            SCREEN_FORCE_HOST_NATIVE_FPS:   -1,                         // -1: auto. Don't change! :-)
            SCREEN_VSYNCH_MODE:             -2,                         // -2: user set (default on); -1: disabled; 0: off; 1: on
            AUDIO_MONITOR_BUFFER_BASE:      -3,                         // -3: user set (default auto); -2: disable audio; -1: auto; 0: browser default; 1..6: base value. More buffer = more delay
            AUDIO_MONITOR_BUFFER_SIZE:      -1,                         // -1: auto; 256, 512, 1024, 2048, 4096, 8192, 16384: buffer size.     More buffer = more delay. Don't change! :-)
            AUDIO_SIGNAL_BUFFER_RATIO:      2,                          // Internal Audio Signal buffer based on Monitor buffer
            AUDIO_SIGNAL_ADD_FRAMES:        3,                          // Additional frames in internal Audio Signal buffer based on Monitor buffer
            PADDLES_MODE:                   -1,                         // -1: auto; 0: off; 1: on
            TOUCH_MODE:                     -1,                         // -1: auto; 0: disabled; 1: enabled; 2: enabled (swapped)
            
            IMAGES_PATH:                    window.JAVATARI_IMAGES_PATH || "images/",
            PAGE_BACK_CSS:                  "",                         // CSS to modify page background color. Applied to the body element
            
            SERVER_ADDRESS:                 "webmsx.azurewebsites.net/",
            SERVER_KEEPALIVE:               0,
            
            RESET:                          0,                          // if value = 1 clear all saved data on the client
            ALLOW_URL_PARAMETERS:           true                        // Allows user to override any of these parameters via URL query parameters
        };
        
        Javatari.PRESETS_CONFIG = { };                                  // No built-in Presets for now
        
        jt = window.jt || {};                                           // Namespace for all classes and objects
    </script>
    
    <script src="javatari.js"></script>
    <script>
    </script>
    <script>
        /*
         * CONFIGURAÇÕES PARA DISCORD ACTIVITIES
         * 
         * Para funcionar corretamente no Discord, configure no Developer Portal:
         * 1. URL Mappings (se necessário):
         *    - /assets -> seu-dominio.com/assets
         *    - /activities -> seu-dominio.com/activities
         * 
         * 2. Todas as URLs devem ser:
         *    - Relativas (como /assets/roms/gatonho.bin)
         *    - Ou usar formato completo: https://{clientId}.discordsays.com/path
         * 
         * 3. Recursos externos bloqueados por padrão (CSP)
         * 4. Cookies precisam: SameSite=None Partitioned
         */
        
        // Configurações específicas para Discord Activities
        const isDiscordActivity = window.location.hostname.includes('discordsays.com');
        const isDevelopment = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
        
        // Configuração de segurança para Discord Activities
        if (isDiscordActivity) {
            // Configurações específicas para ambiente de produção do Discord
            console.log('Executando como Discord Activity');
            
            // Desabilita funcionalidades que podem não funcionar no Discord
            if (window.Javatari) {
                Javatari.SCREEN_FULLSCREEN_MODE = -2; // Desabilita fullscreen no Discord
                Javatari.NETPLAY_JOIN = ""; // Desabilita NetPlay no Discord por segurança
            }
        }
        
        // Inicialização do Javatari
        function initJavatari() {
            if (typeof Javatari === 'undefined') {
                console.error('Javatari não foi carregado!');
                return;
            }
            
            if (isDiscordActivity) {
                console.log('Configurações do Discord Activity aplicadas');
            }
        }
        
        window.addEventListener('load', function() {
            // Remove a mensagem de loading após um tempo
            setTimeout(function() {
                const loadingDiv = document.querySelector('.loading');
                if (loadingDiv) {
                    loadingDiv.remove();
                }
                initJavatari();
            }, 1000);
        });
        
        // Função para redimensionar o emulador responsivamente
        function resizeEmulator() {
            const screen = document.getElementById('javatari-screen');
            const wrapper = document.querySelector('.emulator-wrapper');
            
            if (screen && wrapper) {
                const wrapperRect = wrapper.getBoundingClientRect();
                const controlsHeight = document.querySelector('.controls-info').offsetHeight;
                const availableHeight = wrapperRect.height - controlsHeight - 32; // 32px para padding
                
                screen.style.height = availableHeight + 'px';
            }
        }
        
        // Redimensiona quando a janela muda de tamanho
        window.addEventListener('resize', resizeEmulator);
        
        // Redimensiona após o carregamento
        window.addEventListener('load', function() {
            setTimeout(resizeEmulator, 1500);
        });
        
        // Previne comportamentos indesejados em Discord Activity
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });
        
        // Foca no jogo quando clicado
        document.getElementById('javatari-screen').addEventListener('click', function() {
            this.focus();
        });
    </script>
</body>
</html>